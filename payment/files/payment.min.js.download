var globalRemainingSeconds,terminalDiscountStatus,otpRequestWaitMillis,panDtoList,encRefId,focusedField,shuffledArray,previousPan,keyPadInputId,previousOTPRequestMillis,otpRemainingSeconds,ctrlDown=!1,ctrlKey=17,cmdKey=91,disableCountDown=!1,paymentSuccessfullyDone=!1,successResultSubmitted=!1,cursorPosition=0,selectedPanIndex=-1,previousSelectedPanIndex=-1,availableBankLogos={610433:"mellat",589905:"melli",170019:"melli",603799:"melli",603769:"saderat",639217:"keshavarzi",603770:"keshavarzi",589210:"sepah",627353:"tejarat",628023:"maskan",207177:"tose_saderat",627648:"tose_saderat",627961:"sanat_madan",627760:"postbank",621986:"saman",627412:"eghtesad_novin",639347:"pasargad",502229:"pasargad",639607:"sarmaye",627488:"karafarin",639194:"parsian",622106:"parsian",639346:"sina",589463:"refah",628157:"etebari_tose",504706:"shahr",502806:"shahr",502908:"tose_teavon",502938:"dey",606373:"gharzolhasane_mehr",639370:"etebari_mehr",627381:"ansar",636214:"ayandeh",636949:"hekmat_iranian",505785:"iran_zamin",505416:"gardeshgari",636795:"markazi",504172:"resalat",505801:"kosar",505809:"khavarmianeh",507677:"noor",606256:"melal",639599:"ghavamin"};function validatePaymentInputs(e){var n=!0;validatePan()||(n=!1);e&&!validateInput("inputpin",/\d{5,12}/)&&(n=!1);validateInput("inputcvv2",/\d{3,4}/)||(n=!1);validateDate()||(n=!1);validateInput("inputcaptcha",/\d{5}/)||(n=!1);validateInput("inputemail",/^(\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+)?$/)||(n=!1);(n=document.getElementById("inputpayerid")&&!validateInput("inputpayerid",/\d{1,30}/)?!1:n)?hideMessage():showMessage(i18n.invalidInput);return n}function removeInvalidClassFromPan(){$("#cardnumberbox").parent().parent().removeClass("invalid")}function addInvalidClassToPan(){$("#cardnumberbox").parent().parent().addClass("invalid")}function validatePan(){var e=checkPattern("cardnumber",/\d{4}\s?\d{4}\s?\d{4}\s?\d{4}/)||checkPattern("cardnumber",/(-){4}\s?(-){4}\s?(-){4}\s?\d{4}/)||-1<selectedPanIndex&&checkPattern("cardnumber",/\d{4}\s?\d{2}(×){2}\s?(×){4}\s?\d{4}/);(e?removeInvalidClassFromPan:addInvalidClassToPan)();return e}function doPayment(e,n){var t={pan:0<=selectedPanIndex?null:document.getElementById("cardnumber").value.replace(/ /g,""),selectedPanIndex:selectedPanIndex,pin:document.getElementById("inputpin").value,cvv2:document.getElementById("inputcvv2").value,expireMonth:document.getElementById("inputmonth")?document.getElementById("inputmonth").value:null,expireYear:document.getElementById("inputyear")?document.getElementById("inputyear").value:null,captcha:document.getElementById("inputcaptcha").value,payerId:document.getElementById("inputpayerid")?document.getElementById("inputpayerid").value:null,email:document.getElementById("inputemail").value,savePan:!!document.getElementById("savePanCheckbox")&&document.getElementById("savePanCheckbox").checked};showSubmitSpinner();$.ajax({contentType:"application/json",data:JSON.stringify(t),dataType:"json",success:n,type:"POST",url:e+"?RefId="+encRefId})}function processSaleResponse(e){hideSubmitSpinner();if(e)if("OK"===e.status){paymentSuccessfullyDone=!0;document.forms.resultForm.submit()}else if("BLOCKER_ERROR"===e.status)document.forms.resultForm.submit();else{validatePaymentInputs(!0);if("INVALID_CAPTCHA"===e.status){"-1"===e.responseCode&&refreshCaptcha();showMessage(i18n.invalidInput);$("#inputcaptcha").parent().parent().addClass("invalid")}else{refreshCaptcha();switch(e.status){case"INVALID_PAYER_ID":showMessage(i18n.invalidInput);$("#inputpayerid").parent().parent().addClass("invalid");break;case"SYSTEM_INTERNAL_ERROR":showMessage(i18n.systemInternalError);break;case"INVALID_NATIONAL_CODE":showMessage(e.description);$("#cardnumberbox").parent().parent().addClass("invalid");break;case"SALE_FAILED":if("415"===e.responseCode||"419"===e.responseCode){stopCountDown();showMessage(i18n.transactionTimeout);document.getElementById("ResCode").value=e.responseCode;document.forms.returnForm.submit()}else"11"===e.responseCode&&addInvalidClassToPan();showMessage(e.description)}}}}function refreshCaptcha(){$("#inputcaptcha").val("");document.getElementById("captcha-img").src="captchaimg.jpg?RefId="+encRefId+"&rnd= "+Math.random();enableCaptcha()}function showMessage(e,n){$(".card-errorbox").text(e);n&&$(".card-errorbox").addClass("info-message");$(".card-errorbox").addClass("show");setTimeout("hideMessage()",1e4)}function hideMessage(){$(".card-errorbox").removeClass("show");$(".card-errorbox").removeClass("info-message")}function handleUnknownError(e,n,t){hideSubmitSpinner();hideBankLogoSpinner();enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();0===e.status||404!==e.status&&500!=e.status&&"parsererror"!==n&&("timeout"===n||"abort"===n||"ajaxError"==e.type)?showMessage(i18n.networkError):showMessage(i18n.systemInternalError)}function validateAndDoPayment(e,n){validatePaymentInputs(!0)&&doPayment(e,n)}function removeInvalidClassFromInput(e){$("#"+e).parent().parent().removeClass("invalid")}function validateInput(e,n){return checkPattern(e,n)?(removeInvalidClassFromInput(e),!0):(addInvalidClassToInput(e),!1)}function addInvalidClassToInput(e){$("#"+e).parent().parent().addClass("invalid")}function validateDate(){var e=!0;if(0<$("#inputmonth:visible").length){checkPattern("inputmonth",/\d{2}/)||(e=!1);var n=document.getElementById("inputmonth").value;(n<1||12<n)&&(e=!1)}(e=0<$("#inputyear:visible").length&&!checkPattern("inputyear",/\d{2}/)?!1:e)?removeInvalidClassFromInput("inputmonth"):$("#inputmonth").parent().parent().addClass("invalid");return e}function focusNextField(e,n,t){if(isNumericKeyDownOrUp(getEventKeyCode(t))&&e.value.length>=e.maxLength)for(var a=n.split("|"),i=0;i<a.length;i++){var s=a[i];if(0<$("#"+s+":visible").length){focusField(s);break}}}function focusField(e){e=document.getElementById(e);e.focus();"button"!==e.type&&e.setSelectionRange(0,e.value.length)}function hideKeypadOnTab(e){9===getEventKeyCode(e)&&hideKeypad()}function checkPattern(e,n){return n.test(document.getElementById(e).value)}function setPanCursorPosition(e){var n=document.getElementById("cardnumber"),e=getEventKeyCode(e);cursorPosition=n.selectionStart;if(8===e){if(0!==cursorPosition){n=n.value.substring(n.selectionStart,n.selectionEnd);if(/ /.test(n))5!==cursorPosition&&10!==cursorPosition&&15!==cursorPosition||cursorPosition--;else{6!==cursorPosition&&11!==cursorPosition&&16!==cursorPosition||cursorPosition--;cursorPosition--}cursorPosition=cursorPosition<0?0:cursorPosition}}else if(46===e)4!==cursorPosition&&9!==cursorPosition&&14!==cursorPosition||cursorPosition++;else if(isNumericKeyDownOrUp(e)){3!==cursorPosition&&8!==cursorPosition&&13!==cursorPosition&&4!==cursorPosition&&9!==cursorPosition&&14!==cursorPosition||cursorPosition++;cursorPosition++}}function formatPanOnKeyDown(e){if(shouldIgnore(getEventKeyCode(e)))return!0;var e=document.getElementById("cardnumber"),n=concatNumericChars(e.value,16);e.value=getFormattedPan(n)}function shouldIgnore(e){return!(!e||isNumericKeyDownOrUp(e)||ctrlDown&&86===e)}function formatPanOnKeyUp(e){e=getEventKeyCode(e);if(shouldIgnore(e))return!0;var n=document.getElementById("cardnumber"),t=concatNumericChars(n.value,16);n.value=getFormattedPan(t);e&&isNumericKeyDownOrUp(e)}function getFormattedPan(e){for(var n,t="",a=/\d{1,4}/g;null!=(n=a.exec(e));){0!==t.length&&(t+=" ");t+=n[0]}return t}function concatNumericChars(e,n){for(var t,a="",i=/\d{1,16}/g;null!=(t=i.exec(e))&&a.length<n;)a+=t[0];return a=a.length>n?a.substring(0,n):a}function extractNumbers(e,n){n=concatNumericChars(e.value,n);e.value=n}function preventInvalidKeys(e){var n=getEventKeyCode(e);if(-1!==[16,17,91,0,13,8,9,33,34,35,36,37,38,39,40,45,46].indexOf(n))return!0;if(isNumericKeyDownOrUp(n))return!0;if(ctrlDown)return!0;if(112<=n&&n<=123)return!0;window.event?window.event.returnValue=!1:e.preventDefault();return!1}function isNumericKeyDownOrUp(e){return 47<e&&e<58||95<e&&e<106}function getEventKeyCode(e){return window.event?e.keyCode:e.which}function cancelPay(){document.getElementById("ResCode").value="17";document.forms.returnForm.submit();return!1}function countDownRemainingTime(e){if(!disableCountDown){if(e<=0){stopCountDown();if(!paymentSuccessfullyDone){document.getElementById("ResCode").value="415";document.forms.returnForm.submit()}}else{var n=Math.floor(e/60),t=e%60;$("#remaining-time b").text((n+"").padStart(2,"0")+":"+(t+"").padStart(2,"0"))}globalRemainingSeconds=e-1;setTimeout("countDownRemainingTime(globalRemainingSeconds)",1e3)}}function stopCountDown(){disableCountDown=!0;$("#remaining-time b").text("--:--")}function fillField(e,n){if(focusedField){n.preventDefault();n.stopPropagation();focusedField.focus();var n=e.value,e=focusedField.selectionStart,t=focusedField.selectionEnd,e=e===focusedField.value.length?focusedField.value+n:focusedField.value.substring(0,e)+n+focusedField.value.substring(t,focusedField.value.length);e.length<=focusedField.maxLength&&(focusedField.value=e);focusedField.value.length===focusedField.maxLength&&keypadTab()}return!1}function keypadTab(){hideKeypad();var e="inputpin"===focusedField.id?"payButton":0<$("#inputmonth:visible").length?"inputmonth":"inputcaptcha",e=document.getElementById(e);e.focus();e.setSelectionRange(0,e.value.length)}function keyPadBackspace(e){if(focusedField){e.preventDefault();e.stopPropagation();focusedField.focus();var e=focusedField.selectionStart,n=focusedField.selectionEnd;e===focusedField.value.length?focusedField.value=focusedField.value.substring(0,focusedField.value.length-1):focusedField.value=e===n?focusedField.value.substring(0,e-1)+focusedField.value.substring(n,focusedField.value.length):focusedField.value.substring(0,e)+focusedField.value.substring(n,focusedField.value.length)}return!1}function setFocusedField(e){focusedField=e}function shuffleKeypad(){shuffledArray=shuffle([0,1,2,3,4,5,6,7,8,9]);for(var e=0;e<shuffledArray.length;e++){var n=document.getElementById("num"+e);n.value=shuffledArray[e];n.innerHTML=shuffledArray[e]}}function showKeypadJustInMobile(e,n){window.matchMedia("(max-width: 575.98px)").matches&&showKeypad(e,n)}function showLogoJustInMobile(e){window.matchMedia("(max-width: 575.98px)").matches?$(".merchant-logo").addClass("mobile"):$(".merchant-logo").addClass("nomobile");if(e){e.preventDefault();e.stopPropagation()}return!1}function showKeypad(e,n){keyPadInputId=e;var t=document.getElementById(e);t.focus();setFocusedField(t);shuffledArray||shuffleKeypad();$(".keypad-container").insertAfter("#"+e);$(".keypad-container").addClass("openkeypad");if(n){n.preventDefault();n.stopPropagation()}return!1}function hideKeypad(){$(".keypad-container").removeClass("openkeypad")}function hideOthersKeypad(e){e.id!==keyPadInputId&&hideKeypad()}function shuffle(e){for(var n,t,a=e.length-1;0<a;a--){n=Math.floor(Math.random()*(a+1));t=e[a];e[a]=e[n];e[n]=t}return e}function waitAndSendSuccessResult(e){if(e<=0)document.getElementById("return-button").disabled||sendSuccessResult();else{$(".timer").text(i18n.redirectRemainingTime+e);globalRemainingSeconds=e-1;setTimeout("waitAndSendSuccessResult(globalRemainingSeconds)",1e3)}}function sendSuccessResult(){if(!document.getElementById("return-button").disabled&&!successResultSubmitted){document.getElementById("return-button").disabled=!0;$("#return-button").attr("disabled","disabled").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>'+i18n.redirectingToMerchantSite);$(".timer").hide();document.forms.returnForm.submit();successResultSubmitted=!0;setTimeout("enableReturnButton()",3e4)}}function enableReturnButton(){successResultSubmitted=!1;$("#return-button").attr("disabled","disabled").html(i18n.continueShopping);document.getElementById("return-button").disabled=!1}function hideKeypadOnOutsideClick(e){$(".keypad-container").parent()[0]!==e.target&&0===$(e.target).parents(".keypad-parent").length&&hideKeypad()}function hideCardSuggestionListOnOutSideClick(e){$(".cardnumberbox")[0]!==e.target&&0===$(e.target).parents(".cardnumberbox").length&&hideCardSuggestionList()}function showSubmitSpinner(){$(".btn-decline").hide();$(".btn-submit-form").addClass("perches-requested");$(".btn-perches").attr("disabled","disabled").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>'+i18n.sendingInformation)}function hideSubmitSpinner(){$(".btn-perches").removeAttr("disabled").html(i18n.pay);$(".btn-submit-form").removeClass("perches-requested");$(".btn-decline").show()}function showBankLogoSpinner(){$(".banklogo").append('<span class="spinner-border spinner-border-sm " role="status" aria-hidden="true"></span>')}function hideBankLogoSpinner(){$(".banklogo").find(".spinner-border").remove()}function checkPanDiscount(e){var n=(new Intl.NumberFormat).format(originalAmount),n=($(".price-number").text(n+" "+i18n.rial),"discount.mellat");prepare4DiscountServiceCall();0<=selectedPanIndex?$.post(n,{W_REFID:encRefId,SELECTED_PAN_INDEX:selectedPanIndex},processDiscountResponse):$.post(n,{W_REFID:encRefId,PAN:e},processDiscountResponse)}function handlePanChange(){var e=document.getElementById("cardnumber").value.replace(/ /g,"");if(isNewPan(e)){previousSelectedPanIndex=selectedPanIndex;previousPan=e;enableCaptcha();0<terminalDiscountStatus&&checkPanDiscount(e)}}function prepare4DiscountServiceCall(){showBankLogoSpinner();$("payButton").attr("disabled","disabled")}var processDiscountResponse=function(e){hideBankLogoSpinner();if(e)if("SUCCESSFUL"===e.status){var n=new Intl.NumberFormat,t=n.format(e.discountAmount),n=n.format(e.amountAfterDiscount);if(0!==e.discountAmount){var a=i18n.discountMessage.replace("${amount}",t)+"<br>"+i18n.finalAmount+" "+n+" "+i18n.rial;e.description&&(a+="<br>"+e.description);openDiscountDialog(a,e.amountAfterDiscount)}else e.description&&openDiscountDialog(a=i18n.discountDescriptionMessage.replace("${description}",e.description)+"<br>",e.amountAfterDiscount);$("payButton").removeAttr("disabled")}else"MAX_DISCOUNT_CALL_EXCEEDED"===e.status?showMessage(i18n.maxDiscountCallExceeded):showMessage(i18n.systemErrorInDiscountCheck);else showMessage(i18n.systemErrorInDiscountCheck)};function openDiscountDialog(e,n){$("#discount-body p").html(e);$("#discount-submit-button").click(function(){setAmount(n);hideBankLogoSpinner();hideDiscountDialog()});$("#discount-cancel-button").click(function(){setAmount(originalAmount);hideBankLogoSpinner();hideDiscountDialog();var e=document.getElementById("cardnumber");e.focus();e.setSelectionRange(0,e.value.length)});showDiscountDialog();openkeypad();$("#discount-submit-button").focus()}function setPan(e){$("#cardnumber").val(e);removeInvalidClassFromPan()}function hideDiscountDialog(){$("#discount-modal").hide();$("#discount-modal-backdrop").hide()}function showDiscountDialog(){$("#discount-modal-backdrop").show();$("#discount-modal").show()}function showDynamicPinDialog(){$("#dynamic-pin-modal-backdrop").show();$("#dynamic-pin-modal").show();$(".modal-footer .btn-primary").focus()}function removeDynamicPinDialog(){$("#dynamic-pin-modal").remove();$("#dynamic-pin-modal-backdrop").remove()}function setAmount(e){var n=new Intl.NumberFormat;$(".price-number").text(n.format(e)+" "+i18n.rial)}$(document).ajaxError(handleUnknownError);function setCardSuggestionListHeight(){var e=.7*$(".carddetail").height()+"px";$(".card-suggestionlist").css({"max-height":e})}$(window).resize(setCardSuggestionListHeight);function filterAndShowCardSuggestionList(){var e=[];if(panDtoList)for(var n=document.getElementById("cardnumber").value.replace(/ /g,""),t=0;t<panDtoList.length;t++){var a=panDtoList[t];a.index=t;0===a.maskedPan.lastIndexOf(n,0)&&e.push(a)}showCardSuggestionList(e)}function toggleAllPans(){if(0<$("#card-list-button.close-button").length)hideCardSuggestionList();else{for(var e=0;e<panDtoList.length;e++)panDtoList[e].index=e;showCardSuggestionList(panDtoList);var n=document.getElementById("cardnumber");n.focus();n.setSelectionRange(0,n.value.length)}}function showAllPans(){for(var e=0;e<panDtoList.length;e++)panDtoList[e].index=e;showCardSuggestionList(panDtoList)}function showCardSuggestionList(e){if(0<e.length){$(".card-suggestionlist").children("div:not(.editcard)").remove();for(var n=e.length-1;-1<n;n--){var t=e[n],a=t.maskedPan,i=a.substring(0,6),i='<div class="dropdown-item"> <span class="btn btn-sm zero-margin-right" tabindex="-1" onclick="deleteSelectedPan('+t.index+',event)"><span class="close-button-red"></span></span> <span class="btn btn-sm zero-margin-right"  tabindex="-1"  onclick="selectPan('+t.index+',event);"><span class="zero-margin-right">'+(isBankLogoAvailable(i)?'<img src="'+getBankLogoSrc(i)+'">':"")+"</span>"+a+" "+t.bankName+"</span>  </div>";$(".card-suggestionlist").prepend(i)}$(".cardnumberbox").addClass("opensugestion");$("#card-list-button").addClass("close-button")}else hideCardSuggestionList()}function setBankLogo(){$(".banklogo").children().remove();var e=document.getElementById("cardnumber").value.replace(/ /g,"");if(6<=e.length){e=e.substring(0,6);if(isBankLogoAvailable(e)){e='<img src="'+getBankLogoSrc(e)+'">';$(".banklogo").append(e)}}}function hideCardSuggestionList(){$(".cardnumberbox").removeClass("opensugestion");$("#card-list-button").removeClass("close-button")}function deleteSelectedPan(e,n){if(e<panDtoList.length){var t={pan:panDtoList[e].maskedPan,selectedPanIndex:e};panDtoList.splice(e,1);showCardSuggestionList(panDtoList);$.ajax({contentType:"application/json",data:JSON.stringify(t),dataType:"json",success:processDeleteSelectedPanResponse,type:"POST",url:"mobile-pan-delete-request.mellat?RefId="+encRefId})}else{hideCardSuggestionList();setBankLogo()}}function processDeleteSelectedPanResponse(e){console.log(e)}function selectPan(e,n){selectedPanIndex=-1;if(e<panDtoList.length){var t=panDtoList[e],a=t.maskedPan,i=a.substring(0,4);setPan(i+(" "+a.substring(4,6))+"×× ×××× "+a.substring(a.length-4,a.length));selectedPanIndex=e;t.hasExpireDate&&maskExpireDate();t.email&&$("#inputemail").val(t.email);i=document.getElementById("inputpin"),a=document.getElementById("inputcvv2");a.focus();a.setSelectionRange(0,a.value.length);i.setSelectionRange(0,i.value.length);$("#inputcvv2").val("");hideCardSuggestionList();setBankLogo();handlePanChange();scrollTopAnimated()}else{hideCardSuggestionList();setBankLogo()}}function showKeypadJustInMobile(e,n){window.matchMedia("(max-width: 575.98px)").matches&&showKeypad(e,n)}function scrollTopAnimated(){window.matchMedia("(max-width: 575.98px)").matches&&$("html, body").animate({scrollTop:"269"})}function scrollMiddleAnimated(){window.matchMedia("(max-width: 575.98px)").matches&&$("html, body").animate({scrollTop:"550"})}function cardNumberFocus(){window.matchMedia("(max-width: 575.98px)").matches?showAllPans():$("#cardnumber").focus()}function maskExpireDate(){var e=$("#inputmonth").val("").hide().attr("class"),n=$("#inputyear").val("").hide().attr("class"),e='<input id="inputMonthEnc" type="password" style="background-color: #FFFFFF" class="'+e+'" tabindex="-1" value="**" onclick="unmaskExpireDate(true)" readonly/>';$("#inputmonth").next().remove();$(e).insertAfter("#inputmonth");e='<input id="inputYearEnc" type="password" style="background-color: #FFFFFF" class="'+n+'" tabindex="-1" value="**" onclick="unmaskExpireDate(true)" readonly/>';$("#inputyear").next().remove();$(e).insertAfter("#inputyear")}function unmaskExpireDate(e){$("#inputmonth").next().remove();$("#inputyear").next().remove();e?$("#inputmonth").show().focus():$("#inputmonth").show();$("#inputyear").show()}function isBankLogoAvailable(e){e=parseInt(e);return!!availableBankLogos[e]}function resetSelectedPan(e){if(shouldIgnore(getEventKeyCode(e)))return!0;unmaskExpireDate(!(selectedPanIndex=-1))}function getBankLogoSrc(e){return"img/bank-logo/"+availableBankLogos[e]+".png"}function isNewPan(e){return 0<=selectedPanIndex&&previousSelectedPanIndex!==selectedPanIndex||16===e.length&&previousPan!==e}function validateAndRequestOTP(){if(validatePaymentInputs(!1)){var e=document.getElementById("cardnumber").value.replace(/ /g,"");if(isNewPan(e)){previousSelectedPanIndex=selectedPanIndex;previousPan=e;requestOTP()}else(new Date).getTime()-previousOTPRequestMillis<otpRequestWaitMillis?showMessage(i18n.otpWaitMessage):requestOTP()}}function requestOTP(){var e={pan:0<=selectedPanIndex?null:document.getElementById("cardnumber").value.replace(/ /g,""),selectedPanIndex:selectedPanIndex,captcha:document.getElementById("inputcaptcha").value};disableOtpButton();disableCaptcha();disableCardNumber();disableCvv2KeyPad();disableCardListButton();disableInputCVV2();disableInputMonth();disableInputYear();disableInputMonthEnc();disableInputYearEnc();showBankLogoSpinner();$.ajax({contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:processOtpResponse,type:"POST",url:"otp-request.mellat?RefId="+encRefId})}function showSuccessFulMessageJustInMobile(){window.matchMedia("(max-width: 575.98px)").matches?$(".sendpin").addClass("green"):showMessage(i18n.successFulOTP,!0)}function processOtpResponse(e){hideBankLogoSpinner();if(e)switch(e.status){case"OK":showSuccessFulMessageJustInMobile();previousOTPRequestMillis=(new Date).getTime();countDownDynamicPinRemainingTime(otpRequestWaitMillis/1e3);break;case"INVALID_PAN":showMessage(i18n.invalidPan);enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();break;case"INVALID_CAPTCHA":showMessage(i18n.invalidInput);$("#inputcaptcha").parent().parent().addClass("invalid");enableCaptcha();enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();break;case"EXPIRED_CAPTCHA":showMessage(i18n.invalidInput);$("#inputcaptcha").parent().parent().addClass("invalid");refreshCaptcha();enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();break;case"OTP_WAIT":showMessage(i18n.otpWaitMessage);refreshCaptcha();enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();break;case"BLOCKER_ERROR":document.forms.resultForm.submit();break;case"COMMON_ERROR":showMessage(e.description);enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();break;case"SYSTEM_INTERNAL_ERROR":showMessage(i18n.systemInternalError);enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc()}else showMessage(i18n.systemInternalError)}function disableOtpButton(){$("#otp-button").attr("disabled","disabled")}function enableOtpButton(){$("#otp-button").removeAttr("disabled")}function disableCardNumber(){$("#cardnumber").attr("disabled","disabled")}function enableCardNumber(){$("#cardnumber").removeAttr("disabled")}function disableCvv2KeyPad(){$("#cvv2KeyPad").attr("disabled","disabled")}function enableCvv2KeyPad(){$("#cvv2KeyPad").removeAttr("disabled")}function disableCardListButton(){$("#card-list-button").attr("disabled","disabled")}function enableCardListButton(){$("#card-list-button").removeAttr("disabled")}function disableInputCVV2(){$("#inputcvv2").attr("disabled","disabled")}function enableInputCVV2(){$("#inputcvv2").removeAttr("disabled")}function disableInputMonth(){$("#inputmonth").attr("disabled","disabled")}function enableInputMonth(){$("#inputmonth").removeAttr("disabled")}function disableInputYear(){$("#inputyear").attr("disabled","disabled")}function enableInputYear(){$("#inputyear").removeAttr("disabled")}function disableInputMonthEnc(){$("#inputMonthEnc").attr("disabled","disabled")}function enableInputMonthEnc(){$("#inputMonthEnc").removeAttr("disabled")}function disableInputYearEnc(){$("#inputYearEnc").attr("disabled","disabled")}function enableInputYearEnc(){$("#inputYearEnc").removeAttr("disabled")}function disableCaptcha(){$("#captcha-button").attr("disabled","disabled");$("#inputcaptcha").attr("disabled","disabled")}function enableCaptcha(){$("#captcha-button").removeAttr("disabled");$("#inputcaptcha").removeAttr("disabled")}function showRetryMessageJustInMobile(){window.matchMedia("(max-width: 575.98px)").matches?$(".sendpin").removeClass("green"):showMessage(i18n.otpRetryMessage)}function countDownDynamicPinRemainingTime(e){if(e<=0){$("#otp-button").text(i18n.otpRequest);enableOtpButton();enableCardNumber();enableCvv2KeyPad();enableCardListButton();enableInputCVV2();enableInputMonth();enableInputYear();enableInputMonthEnc();enableInputYearEnc();refreshCaptcha();showRetryMessageJustInMobile()}else{var n=Math.floor(e/60),t=e%60;$("#otp-button").text((n+"").padStart(2,"0")+":"+(t+"").padStart(2,"0"));otpRemainingSeconds=e-1;setTimeout("countDownDynamicPinRemainingTime(otpRemainingSeconds)",1e3)}}
